@*@typeparam T*@

<div class="modal fade @(IsVisible ? "show" : "")"
     style="display: @(IsVisible ? "block" : "none");"
     tabindex="-1"
     role="dialog"
     aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" style="z-index:1055">
        <div class="modal-content px-5">
            <div class="modal-body border-0 p-0 mt-4">
                <div class="container p-2 text-center">
                    <div class="row mb-3 justify-content-center">
                        @switch (Modal.OptionType)
                        {
                            case OptionType.Success:
                                <i class="bi bi-patch-check-fill text-success" style="font-size: 3.5rem;"></i>
                                break;
                            case OptionType.Warning:
                                <i class="bi bi-exclamation-triangle-fill text-warning" style="font-size: 3.5rem;"></i>
                                break;
                            case OptionType.Error:
                                <i class="bi bi-x-octagon-fill text-danger" style="font-size: 3.5rem;"></i>
                                break;
                            default:
                                <i class="bi bi-info-circle-fill text-info" style="font-size: 3.5rem;"></i>
                                break;
                        }
                    </div>
                    <div class="row mb-2">
                        <h5>@Modal.Title</h5>
                    </div>
                    <div class="row mb-3">
                        <h6>@Modal.Message</h6>
                    </div>
                </div>
            </div>
            <div class="modal-footer @(HasSingleButton ? "justify-content-center" : "justify-content-between") border-0 p-0 mb-3">
                @if (Modal.OptionType == OptionType.Confirmation)
                {
                    <button class="btn btn-outline-primary"
                            style="width:7rem"
                            @onclick="CloseModal">
                        Cancel
                    </button>
                    <button class="btn btn-primary"
                            style="width:7rem"
                            @onclick="ConfirmOption">
                        @(Modal.ButtonText ?? "Confirm")
                    </button>
                }
                else
                {
                    <button class="btn btn-primary"
                            style="width:7rem"
                            @onclick="CloseModal">
                        @(Modal.ButtonText ?? "OK")
                    </button>
                }
            </div>
        </div>
    </div>   
</div>
@if (IsVisible)
{
    <div class="modal-backdrop fade show" style="z-index:1000"></div>
}

@code {
    [Parameter] public bool IsVisible { get; set; }
    [Parameter] public ModalOptionDto Modal { get; set; } = default!;
    [Parameter] public EventCallback OnCloseModal { get; set; }
    [Parameter] public EventCallback OnConfirmModal { get; set; }
    //[Parameter] public T? Data { get; set; }

    private bool HasSingleButton =>
        Modal.OptionType != OptionType.Confirmation;

    private async Task CloseModal()
    {
        if (OnCloseModal.HasDelegate)
            await OnCloseModal.InvokeAsync();
    }

    private async Task ConfirmOption()
    {
        if (OnConfirmModal.HasDelegate)
            await OnConfirmModal.InvokeAsync();
    }
}